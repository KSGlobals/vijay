<div class="container1">
  <br />
  <div class="row">
    <div class="col-lg-4"><h1>Project Details</h1></div>
    <div class="col-lg-8 remove">
      <div class="row">
        <div class="frame-1171275852">
          <div class="col-lg-8">
            <div class="frame-1171275846">
              <div class="frame-1171275845">
                <div class="icons">
                  <div
                    class="vuesax-linear-search-normal"
                    style="margin-left: 50%"
                  >
                    <i class="fa fa-search" aria-hidden="true"></i>
                  </div>
                </div>
                <input
                  style="border: none; outline: none"
                  class="search-for-anything"
                  type="text"
                  [(ngModel)]="filterValue"
                  (input)="applyFilter()"
                  placeholder="Search for anything..."
                />
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="frame-1171275851" (click)="profile()">
              <img class="ellipse-3226" [src]="img" />
              <div class="frame-1171275855">
                <div class="frame-1171275849">
                  <div class="alex-meian">{{ userName }}</div>
                  <div class="prodcut-manager">{{ userType }}</div>
                </div>
                <!--                 <svg
                  class="icons2"
                  width="14"
                  height="14"
                  viewBox="0 0 14 14"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M2.69038 4.60367C2.49709 4.80248 2.49709 5.12482 2.69038 5.32363L6.64997 9.39636C6.74279 9.49183 6.86869 9.54547 6.99996 9.54547C7.13122 9.54547 7.25712 9.49183 7.34994 9.39636L11.3095 5.32363C11.5028 5.12482 11.5028 4.80248 11.3095 4.60367C11.1162 4.40486 10.8029 4.40486 10.6096 4.60367L6.99996 8.31641L3.39034 4.60367C3.19705 4.40486 2.88367 4.40486 2.69038 4.60367Z"
                    fill="#292D32"
                  />
                </svg>-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="top-header">
  <h2>Project Details</h2>
  <form>
    <div class="AddIcon" style="position: relative">
      <button
        style="margin-right: 44px"
        (click)="viewAddTask()"
        class="btn btn-info pull-right"
      >
        <i class="fa fa-plus"></i>Add Project
      </button>
    </div>
  </form>
</div>
<div class="row tablecon">
  <table class="table">
    <thead>
      <tr>
        <th>S.NO</th>
        <th>Project&nbsp;Name</th>
        <th>Company</th>
        <th>SPOC</th>
        <th>Project&nbsp;Manager</th>
        <th>Status</th>
        <!-- <th>Note</th> -->
        <th style="transform: translateX(9%)">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="
          let task of filterValue ? filteredData : companies;
          let i = index
        "
      >
        <td>{{ i + 1 }}</td>
        <td>{{ task.title }}</td>
        <td>{{ task.company }}</td>
        <td>{{ task.SPOC }}</td>
        <td>{{ task.manager }}</td>
        <td style="width: 10%">{{ task.status }}</td>
        <td>
          <span *ngIf="task.status === 'Pending'">Not Started</span>
          <button
            *ngIf="task.status === 'In Progress'"
            class="fa fa-upload"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="startTask(task)"
          ></button>
          <button
            *ngIf="task.status === 'Rework'"
            class="fa fa-upload"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="reTask(task)"
          ></button>
          <button
            *ngIf="
              task.status === 'Completed' ||
              task.status === 'In Approval' ||
              task.status === 'Delete Request' ||
              task.status === 'Rework'
            "
            class="fa fa-eye"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="viewTask(companies[i].title, companies[i].uploadedBy)"
          ></button>
          <button
            *ngIf="task.status === 'In Approval'"
            class="fa fa-check"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="approve(task)"
          ></button>
          <button
            *ngIf="task.status === 'In Approval'"
            class="fa fa-ban"
            style="
              border: none;
              color: rgb(155, 22, 22);
              background-color: transparent;
              font-size: 24px;
            "
            (click)="deny(task)"
          ></button>
          <button
            class="fa fa-edit"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="editTask(task)"
          ></button>
          <button
            *ngIf="task.status === 'Completed'"
            class="fa fa-download"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="downloadFile(task)"
          ></button
          ><button
            class="fa fa-trash"
            style="
              border: none;
              color: rgb(155, 22, 22);
              background-color: transparent;
              font-size: 24px;
            "
            (click)="delete(task)"
          ></button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div
  class="container mobile-table"
  *ngFor="let task of companies; let i = index"
>
  <div class="card">
    <div class="title">
      <h3>Project {{ i + 1 }}</h3>
    </div>
    <div class="details">
      <!-- <h3>Allocated Date : <span>{{ allocatedDate }}</span> </h3> -->
      <h3>
        Project Title : <span>{{ task.title }}</span>
      </h3>
      <h3>
        Company: <span>{{ task.company }}</span>
      </h3>
      <h3>
        SPOC : <span>{{ task.SPOC }}</span>
      </h3>
      <h3>
        Project Manager : <span>{{ task.manager }}</span>
      </h3>
      <h3>
        Status : <span>{{ task.status }}</span>
      </h3>
      <h3>
        Action :
        <span
          ><span *ngIf="task.status === 'Pending'">Not Started</span>
          <button
            *ngIf="task.status === 'In Progress'"
            class="fa fa-upload"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="startTask(task)"
          ></button>
          <button
            *ngIf="task.status === 'Rework'"
            class="fa fa-upload"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="reTask(task)"
          ></button>
          <button
            *ngIf="
              task.status === 'Completed' ||
              task.status === 'In Approval' ||
              task.status === 'Delete Request' ||
              task.status === 'Rework'
            "
            class="fa fa-eye"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="viewTask(companies[i].title, companies[i].uploadedBy)"
          ></button>
          <button
            *ngIf="task.status === 'In Approval'"
            class="fa fa-check"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="approve(task)"
          ></button>
          <button
            *ngIf="task.status === 'In Approval'"
            class="fa fa-ban"
            style="
              border: none;
              color: rgb(155, 22, 22);
              background-color: transparent;
              font-size: 24px;
            "
            (click)="deny(task)"
          ></button>
          <button
            class="fa fa-edit"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="editTask(task)"
          ></button
          ><button
            *ngIf="task.status === 'Completed'"
            class="fa fa-download"
            style="
              border: none;
              color: #002e83;
              background-color: transparent;
              font-size: 24px;
            "
            (click)="downloadFile(task)"
          ></button
          ><button
            class="fa fa-trash"
            style="
              border: none;
              color: rgb(155, 22, 22);
              background-color: transparent;
              font-size: 24px;
            "
            (click)="delete(task)"
          ></button
        ></span>
      </h3>
    </div>
  </div>
</div>

<div class="popup-container" *ngIf="showPopup">
  <div class="popup">
    <h3 style="display: flex; align-items: center">
      Project<i
        class="fa fa-times"
        id="closeicon"
        aria-hidden="true"
        (click)="closePopup()"
      ></i>
    </h3>
    <hr />
    <form [formGroup]="ProjectForm" (ngSubmit)="allocateUser()">
      <div class="form-group">
        <label for="reason">Project Name</label>
        <input
          type="text"
          class="form-control"
          formControlName="title"
          [(ngModel)]="selectedTask.title"
        />
      </div>
      <div class="form-group">
        <label for="reason">ORTHOMOSAIC</label>
        <input
          type="file"
          accept=".pdf, .tif, .png"
          class="form-control"
          formControlName="ortho"
          multiple
          (change)="onFileSelected($event)"
        />
        <ul>
          <li *ngFor="let file of selectedFiles">
            {{ file.name }}
            <button
              class="fa fa-trash"
              style="
                border: none;
                color: rgb(155, 22, 22);
                background-color: white;
              "
              (click)="onDelete(file)"
            ></button>
            <button
              class="fa fa-download"
              (click)="onDownload(file)"
              style="
                border: none;
                color: rgb(9, 126, 58);
                background-color: white;
              "
            ></button>
          </li>
        </ul>
      </div>
      <div class="form-group">
        <label for="reason">DEM</label>
        <input
          type="file"
          accept=".pdf, .tif, .png"
          class="form-control"
          formControlName="dem"
          multiple
          (change)="onFileSelected1($event)"
        />
        <ul>
          <li *ngFor="let file of selectedFiles1">
            {{ file.name }}
            <button
              class="fa fa-trash"
              style="
                border: none;
                color: rgb(155, 22, 22);
                background-color: white;
              "
              (click)="onDelete1(file)"
            ></button>
            <button
              class="fa fa-download"
              (click)="onDownload(file)"
              style="
                border: none;
                color: rgb(9, 126, 58);
                background-color: white;
              "
            ></button>
          </li>
        </ul>
      </div>
      <div class="form-group">
        <label for="reason">SURVEY DRAWING</label>
        <input
          type="file"
          accept=".pdf"
          class="form-control"
          formControlName="sd"
          multiple
          (change)="onFileSelected2($event)"
        />
        <ul>
          <li *ngFor="let file of selectedFiles2">
            {{ file.name }}
            <button
              class="fa fa-trash"
              style="
                border: none;
                color: rgb(155, 22, 22);
                background-color: white;
              "
              (click)="onDelete2(file)"
            ></button>
            <button
              class="fa fa-download"
              (click)="onDownload(file)"
              style="
                border: none;
                color: rgb(9, 126, 58);
                background-color: white;
              "
            ></button>
          </li>
        </ul>
      </div>
      <div class="form-group">
        <label for="reason">3D-MODEL</label>
        <input
          type="file"
          accept=".fbx, .obj,.jpg,.jpeg,.png"
          class="form-control"
          formControlName="td"
          multiple
          (change)="onFileSelected3($event)"
        />
        <ul>
          <li *ngFor="let file of selectedFiles3">
            {{ file.name }}
            <button
              class="fa fa-trash"
              style="
                border: none;
                color: rgb(155, 22, 22);
                background-color: white;
              "
              (click)="onDelete3(file)"
            ></button>
            <button
              class="fa fa-download"
              (click)="onDownload(file)"
              style="
                border: none;
                color: rgb(9, 126, 58);
                background-color: white;
              "
            ></button>
          </li>
        </ul>
      </div>
      <div class="form-group">
        <label for="reason">KMZ</label>
        <input
          type="file"
          accept=".kml, .kmz"
          class="form-control"
          formControlName="map"
          multiple
          (change)="onFileSelected4($event)"
        />
        <ul>
          <li *ngFor="let file of selectedFiles4">
            {{ file.name }}
            <button
              class="fa fa-trash"
              style="
                border: none;
                color: rgb(155, 22, 22);
                background-color: white;
              "
              (click)="onDelete4(file)"
            ></button>
            <button
              class="fa fa-download"
              (click)="onDownload(file)"
              style="
                border: none;
                color: rgb(9, 126, 58);
                background-color: white;
              "
            ></button>
          </li>
        </ul>
      </div>
      <div class="form-group">
        <label for="reason">3D Url</label>
        <input type="text" class="form-control" formControlName="url" />
      </div>
      <div class="form-group">
        <label for="reason">Split KMZ</label>
        <input type="checkbox" [(ngModel)]="toggle" (change)="toggling()" />
      </div>
      <div class="form-group" *ngIf="toggle">
        <label for="reason">Split KMZ</label>
        <input
          type="file"
          accept=".kml, .kmz"
          class="form-control"
          formControlName="map"
          multiple
          (change)="onFileSelected5($event)"
        />
        <ul>
          <li *ngFor="let file of selectedFiles4">
            {{ file.name }}
            <button
              class="fa fa-trash"
              style="
                border: none;
                color: rgb(155, 22, 22);
                background-color: white;
              "
              (click)="onDelete5(file)"
            ></button>
            <button
              class="fa fa-download"
              (click)="onDownload(file)"
              style="
                border: none;
                color: rgb(9, 126, 58);
                background-color: white;
              "
            ></button>
          </li>
        </ul>
      </div>
      <button
        id="allocate"
        type="submit"
        class="btn btn-outline-info"
        (click)="allocateUser()"
      >
        Upload Files
      </button>
    </form>
  </div>
</div>
<div class="popup-container" *ngIf="showPopup1">
  <div class="popup">
    <h3 style="display: flex; align-items: center">
      Project<i
        class="fa fa-times"
        id="closeicon"
        aria-hidden="true"
        (click)="closePopup1()"
      ></i>
    </h3>
    <hr />
    <form [formGroup]="ProjectForm" (ngSubmit)="allocateUser()">
      <div class="form-group">
        <label for="reason">Project Name</label>
        <input
          type="text"
          class="form-control"
          formControlName="title"
          [(ngModel)]="selectedTask.title"
        />
      </div>
      <div *ngIf="!value.Downloadurl1">
        <div class="form-group">
          <label for="reason">ORTHOMOSAIC</label>
          <input
            type="file"
            accept=".pdf, .tif, .png"
            class="form-control"
            formControlName="ortho"
            multiple
            (change)="onFileSelected($event)"
          />
          <ul>
            <li *ngFor="let file of selectedFiles">
              {{ file.name }}
              <button
                class="fa fa-trash"
                style="
                  border: none;
                  color: rgb(155, 22, 22);
                  background-color: white;
                "
                (click)="onDelete(file)"
              ></button>
              <button
                class="fa fa-download"
                (click)="onDownload(file)"
                style="
                  border: none;
                  color: rgb(9, 126, 58);
                  background-color: white;
                "
              ></button>
            </li>
          </ul>
        </div>
      </div>
      <div *ngIf="!value.Downloadurl4">
        <div class="form-group">
          <label for="reason">DEM</label>
          <input
            type="file"
            accept=".pdf, .tif, .png"
            class="form-control"
            formControlName="dem"
            multiple
            (change)="onFileSelected1($event)"
          />
          <ul>
            <li *ngFor="let file of selectedFiles1">
              {{ file.name }}
              <button
                class="fa fa-trash"
                style="
                  border: none;
                  color: rgb(155, 22, 22);
                  background-color: white;
                "
                (click)="onDelete1(file)"
              ></button>
              <button
                class="fa fa-download"
                (click)="onDownload(file)"
                style="
                  border: none;
                  color: rgb(9, 126, 58);
                  background-color: white;
                "
              ></button>
            </li>
          </ul>
        </div>
      </div>
      <div *ngIf="!value.Downloadurl6">
        <div class="form-group">
          <label for="reason">SURVEY DRAWING</label>
          <input
            type="file"
            accept=".pdf"
            class="form-control"
            formControlName="sd"
            multiple
            (change)="onFileSelected2($event)"
          />
          <ul>
            <li *ngFor="let file of selectedFiles2">
              {{ file.name }}
              <button
                class="fa fa-trash"
                style="
                  border: none;
                  color: rgb(155, 22, 22);
                  background-color: white;
                "
                (click)="onDelete2(file)"
              ></button>
              <button
                class="fa fa-download"
                (click)="onDownload(file)"
                style="
                  border: none;
                  color: rgb(9, 126, 58);
                  background-color: white;
                "
              ></button>
            </li>
          </ul>
        </div>
      </div>
      <div *ngIf="!value.Downloadurl7">
        <div class="form-group">
          <label for="reason">3D-MODEL</label>
          <input
            type="file"
            accept=".fbx, .obj,.jpg,.jpeg,.png"
            class="form-control"
            formControlName="td"
            multiple
            (change)="onFileSelected3($event)"
          />
          <ul>
            <li *ngFor="let file of selectedFiles3">
              {{ file.name }}
              <button
                class="fa fa-trash"
                style="
                  border: none;
                  color: rgb(155, 22, 22);
                  background-color: white;
                "
                (click)="onDelete3(file)"
              ></button>
              <button
                class="fa fa-download"
                (click)="onDownload(file)"
                style="
                  border: none;
                  color: rgb(9, 126, 58);
                  background-color: white;
                "
              ></button>
            </li>
          </ul>
        </div>
      </div>
      <div *ngIf="!value.Downloadurl10">
        <div class="form-group">
          <label for="reason">KMZ</label>
          <input
            type="file"
            accept=".kml, .kmz"
            class="form-control"
            formControlName="map"
            multiple
            (change)="onFileSelected4($event)"
          />
          <ul>
            <li *ngFor="let file of selectedFiles4">
              {{ file.name }}
              <button
                class="fa fa-trash"
                style="
                  border: none;
                  color: rgb(155, 22, 22);
                  background-color: white;
                "
                (click)="onDelete4(file)"
              ></button>
              <button
                class="fa fa-download"
                (click)="onDownload(file)"
                style="
                  border: none;
                  color: rgb(9, 126, 58);
                  background-color: white;
                "
              ></button>
            </li>
          </ul>
        </div>
      </div>
      <button
        id="allocate"
        type="submit"
        class="btn btn-outline-info"
        (click)="allocateUser()"
      >
        Update Files
      </button>
    </form>
  </div>
</div>
<div class="popup-container" *ngIf="showEditPopup">
  <div class="popup">
    <h3>Edit Details</h3>
    <hr />
    <form
      [formGroup]="ProjectForm"
      *ngIf="selectedTask"
      (ngSubmit)="updateTask()"
    >
      <div class="form-group">
        <label for="firstName">Project Name</label>
        <input
          type="text"
          class="form-control"
          formControlName="title"
          value="{{ selectedTask.title }}"
          readonly
        />
      </div>
      <div class="form-group">
        <label for="firstName">Company Name</label>
        <select
          class="form-control"
          formControlName="company"
          [(ngModel)]="selectedCompany"
          value="{{ selectedTask.company }}"
          (change)="fetchSPOC()"
        >
          <option *ngFor="let company of documentId" [value]="company">
            {{ company }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="status">SPOC Name</label>
        <select
          class="form-control"
          formControlName="SPOC"
          [(ngModel)]="selectedSPOC"
          value="{{ selectedTask.SPOC }}"
        >
          <option *ngFor="let SPOC of selectedSPOC" [value]="SPOC">
            {{ SPOC }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="status">Project Manager Name</label>
        <select
          class="form-control"
          formControlName="manager"
          value="{{ selectedTask.manager }}"
        >
          <option *ngFor="let manager of projectManagers" [value]="manager">
            {{ manager }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <div class="buttons">
          <button
            type="submit"
            class="btn btn-outline-info"
            type="submit"
            (click)="updateTask()"
          >
            Update
          </button>
          <button class="btn btn-outline-secondary" (click)="cancelEdit()">
            Cancel
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
<div class="popup-container" *ngIf="showDeletePopup">
  <div class="popup">
    <h3>Are you sure you want to delete this one?</h3>
    <div class="delete_button">
      <button
        class="btn btn-outline-info"
        (click)="deleteTask(deleteselectedTask)"
      >
        Yes
      </button>
      <button class="btn btn-outline-secondary" (click)="camceldelete()">
        No
      </button>
    </div>
  </div>
</div>
